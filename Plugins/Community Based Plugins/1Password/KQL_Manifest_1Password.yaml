Descriptor:
  Name: 1Password
  DisplayName: 1Password (Community)
  Description: Integrates 1Password with Microsoft Sentinel via KQL queries, enabling visibility into Security Copilot Portal login activity. Provides insights into user behviour events for enhanced security monitoring.
  Settings:
    - Name: TenantId
      Required: true
    - Name: SubscriptionId
      Required: true
    - Name: ResourceGroupName
      Required: true
    - Name: WorkspaceName
      Required: true
  SupportedAuthTypes:
    - None

SkillGroups:
  - Format: KQL
    Skills:
      - Name: 1PasswordEvents
        DisplayName: Failed user login events
        Description: Fetches failed user login events from 1Password
        Settings:
          Target: Sentinel
          # The ID of the AAD Organization that the Sentinel workspace is in.
          TenantId: '{{TenantId}}'
          # The id of the Azure Subscription that the Sentinel workspace is in.
          SubscriptionId: '{{SubscriptionId}}'
          # The name of the Resource Group that the Sentinel workspace is in.
          ResourceGroupName: '{{ResourceGroupName}}'
          # The name of the Sentinel workspace.
          WorkspaceName: '{{WorkspaceName}}'

          Template: |-
            OnePasswordEventLogs_CL
            | where object_type == "vault"
            | extend
                TargetUsername = actor_details.email
                , SrcIpAddr = session.ip